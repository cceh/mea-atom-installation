From 192214e132eee317cb1d76f8b632d6f10d492e62 Mon Sep 17 00:00:00 2001
From: Gioele Barabucci <gioele.barabucci@uni-koeln.de>
Date: Tue, 17 Jun 2014 15:18:34 +0200
Subject: [PATCH] Avoid requiring the PHP readline extension if not necessary

---
 lib/task/tools/addSuperuserTask.class.php | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/lib/task/tools/addSuperuserTask.class.php b/lib/task/tools/addSuperuserTask.class.php
index 0118798..2a75beb 100644
--- a/lib/task/tools/addSuperuserTask.class.php
+++ b/lib/task/tools/addSuperuserTask.class.php
@@ -57,9 +57,10 @@ EOF;
    */
   public function execute($arguments = array(), $options = array())
   {
-    if (!function_exists('readline'))
+    $needsData = !$arguments['username'] || !$options['email'] || !$options['password'];
+    if ($needsData && !function_exists('readline'))
     {
-      throw new Exception('This tasks needs the PHP readline extension.');
+      throw new Exception('This tasks needs the PHP readline extension: not all the parameters have been supplied.');
     }
 
     sfContext::createInstance($this->configuration);
-- 
1.9.1

